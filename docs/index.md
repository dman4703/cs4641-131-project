# High‑Conviction Mean Reversion Trader
Devon O'Quinn, Shayali Patel, Nicholas Nitsche, Julien Perez, Mutimu Njenga

## Introduction
Intraday equities often oscillate around fair‑value anchors rather than drift directionally. A plausible trading stratey when operating with limited capital is to focus on high‑probability “snap‑back” trades: entering only when price stretches far from a reference point such as the volume‑weighted average price (VWAP). VWAP is the cumulative average price a stock traded for one day [1]. The anchored VWAP (AVWAP) is essentially the same, but starts computing VWAP at a user‑set time that is different from the start of the trading day. Using AVWAP lets traders see whether buyers or sellers have dominated since the anchor [1]. Another useful tool to analyze are bollinger bands. They are formed by adding and subtracting standard deviations (usually two) from a simple moving average, and widen when volatility rises and shrink when it falls [2]. Price nearing the upper band indicates overbought conditions, and the price nearing the lower band indicates oversold conditions [2]. These anchors and bands provide intuitive measures of overextension, but executing trades naively on them can lead to over‑trading and untested stops. Hence, machine learning can be used to determine the best opportunities and set exits based on data rather than heuristic rules.

### Literature Review
The VWAP was introduced as “the price a ‘naive’ trader can expect to obtain”; buyers should fill at a price below VWAP and sellers should fill at a price above VWAP [1]. Because AVWAP starts computing from a chosen anchor and can measure over any time inverval, if price stays above a rising AVWAP, buyers are in control; if price falls below a declining AVWAP, sellers are in control [1]. Bollinger serve as a secondary indicator of market trends and volatility (they are a lagging indicator- not predictive); they are particulary useful for mean‑reversion strategies and can signal breakouts & breakdowns [2].

Label quality is critical in supervised trading models. López de Prado defines a “triple‑barrier” method, where there are three barriers for each event: a profit‑taking level, a stop‑loss level, and a vertical barrier representing a maximum holding period; the event’s label depends on which barrier is hit first. This dynamic, volatility‑scaled approach avoids naive fixed‑horizon labels and works on the premise that the path taken matters. Additionally, event‑based sampling using CUSUM filters and activity‑based bars (tick, volume or dollar bars) should be used to regularize data and avoid heteroscedastic time‑bar sampling [3].

A Gaussian mixture models (GMM) is a soft clustering algoirthm that assumes the data are generated by a mixture of Gaussian distributions, assigning each point a probability of belonging to different clusters [4]. For intraday mean-reversion, this provides a probabilistic “overexstension score” rather than a hard cutoff. A GMM trained on the joint distribution of features (such as distance from VWAP, Bollinger position, short-term momentum, and relative volume) can adapt to changing volatility and feature correlations. Observations with low likelihood under the model are flagged as potential “overextensions.” Thus, GMMs are more flexible than outlier detection methods such z-score thresholds, since they capture heavy tails, intraday regime shifts, and multidimensional relationships among features.

A Random Forest is an ensemble meta‑estimator that fits many decision tree classifiers on random sub‑samples of the data and averages their predictions [5]. Random Forests reduce variance and overfitting by injecting randomness into both the data sampling and feature subsampling. López de Prado cautions that naïve bootstrap aggregating can overstate performance when labels overlap; using sequential bootstrap and limiting the number of samples to the average uniqueness of labels is a better method [3]. For opportunity classification, Random Forests are well suited because intraday features are nonlinear, noisy, and often interact (e.g., a momentum burst may only matter in combination with a volume surge). Additionally, this model is robust to outliers and adaptable to the differing qualities of VWAP distance, Bollinger position, trend slope, and time-of-day encodings. In the trading context, the model’s output probabilities map to position sizes and whether to trade or not to trade.

Gradient-boosted models (GBMs) build strong predictors by sequentially adding decision trees that correct residuals [6]. In particular, GBMs can be adapted to quantile regression, allowing for estimation of conditional quantiles (e.g., price reversion magnitude). Recent work shows that gradient-boosted quantile models outperform classical quantile regression in high-dimensional, nonlinear settings [7]. In exit modeling, this ability is critical: the target is to set dynamic stops and take-profits based on different percentiles (e.g. 10th, 50th, 90th quantiles) of the future price reversal distribution rather than targeting a single expected reversion (mean). Additionally, the exit magnitudes are often driven by nonlinear interactions between features. Thus, GBM is a good candidate for exit modeling. 

Lastly, model evaluation requires careful consideration. Traditional random test/train splits fails for financial data because features and labels are serially correlated; today’s market conditions are influenced by yesterday’s [3]. López de Prado discusses the purged k-fold with embargo: in this approach, folds are created from contiguous time blocks. Training samples that overlap in time with the test fold are removed, and a short “embargo” period after the test fold is also excluded to prevent near-term dependence. This leads into Combinatorial Purged Cross-Validation (CPCV), which considers every possible combination of such purged and embargoed folds. Instead of giving a single performance estimate, CPCV produces a distribution of out-of-sample metrics, providing a more reliable measure of model performance and reducing the risk of false discoveries or overfitting [3].

### Dataset Description
Stock data will be sourced from Georgia Tech's Bloomberg Terminal.

## Objective

### Problem
Given an overextension event where price is far from an AVWAP, determine whether the price will revert sufficiently within the next 15–30 minutes to yield a profitable mean‑reversion trade. If a profitable reversion is likely, predict the distribution of return magnitudes to set dynamic take‑profit and stop‑loss levels (quantile regression).

### Motivation
High‑frequency trading strategies require frequent trades and thus high turnover; in contrast, low capital trading neccesitates low‑turnover & high‑conviction trades. AVWAP and Bollinger bands are widely used by practitioners, but trading every deviation generates excessive slippage and commissions. By using unsupervised detection to identify deviations, supervised classifiers to filter high‑probability opportunities, and quantile regression to size exits, we hope to build a reslient, profitable mean‑reversion strategy.

## Methods

### Data Preprocessing
1. **Stock selection.** We will consider liquid U.S. equities. Specifically, we choose the top names by both share and notional average daily volume (ADV). We also require tight bid–ask spreads (e.g., less than 2–3 basis points), a minimum number of trades per minute during regular hours, and the absence of disruptive events such as earnings announcements or corporate actions. This ensures that the data represent actively traded, low-friction securities.

2. **Data Collection Window.** We focus on regular trading hours but exclude the first and last 5 minutes of the day to avoid distortions from opening and closing auctions. We remove duplicate data, data affected by trading halts, and out-of-order data.

3. **Bar Construction.** Tick data are aggregated into event-based bars (volume or dollar bars) to normalize information content across time and reduce heteroskedasticity.

4. **Feature engineering.** For each bar, we compute distance from VWAP (expressed as a z-score), position within Bollinger Bands, short-term momentum bursts (return velocity), volume surges relative to a rolling baseline, time-of-day, and a short-term context feature (by looking at the highest and lowest prices, and the corresponding trading volumes, over the past five minutes). The last feature gives the model awareness of recent trading conditions.

5. **Normalization.** We standardize all engineered features per asset, per session so magnitudes are comparable across symbols with different price levels and volatilities.

6. **Labeling.** We use the triple-barrier method to assign labels. A trade is labeled successful if the price returns toward VWAP before hitting a stop-loss or the maximum holding time (15–30 minutes). This makes the labels path-aware and directly aligned with the trading strategy.

7. **Train/test splitting.** To avoid information leakage, we use purged k-fold cross-validation with embargo. 

### Models
1. **Unsupervised overextension detector.** Fit a Gaussian mixture model on the event features of each instrument to model the “normal” state. Events whose log‑likelihood falls below a threshold are flagged as overextended candidates.

2. **Supervised opportunity classifier.** Each overextension event becomes a labeled training sample with the features specified in data preprocessing. A Random Forest classifier is trained on all the overextensions. At runtime, the model outputs probability of reversion to new overextended candidates.

3. **Supervised exit model.** On the subset of events predicted to revert with high probability, we fit a gradient boosted model to predict the τ‑quantile of cumulative return over the holding period. We will use the 0.1 quantile as the stop loss condition and the 0.5 quantile as the target condition.

## Results & Discussion

### Metrics
We will report mean and standard deviation of F1 scores and negative log‑loss from purged k‑fold cross‑validation for the classifier, along with the proportion of events the model chooses to trade. For the exit model, we will evaluate the calibration of predicted quantiles and use out‑of‑sample profit‑and‑loss per trade and Sharpe ratio as final metrics. The CPCV procedure produces a distribution of Sharpe ratios, allowing us to compute confidence intervals and assess the stability of the strategy.

### Project Goals
- Develop a functioning ML pipeline that can be run on intraday data for multiple different trading assets.
- Show that the trading system performs better than naive heuristic trading.

### Expected Outcomes
We expect the strategy to trade only a small number of overextensions, with a sucess rate significantly above random. We also expect it to perform better than standard heuristic trading.

## Team Logistics

### Gantt Chart
...

### Contribution Table
...

## References
[1] B. Shannon, “Anchored VWAP,” Alphatrends. [Online]. Available: https://alphatrends.net/anchored-vwap/.

[2] C. Thompson, “Understanding Bollinger Bands: A Key Technical Analysis Tool for Investors,” Investopedia, Sep. 3, 2025. [Online]. Available: https://www.investopedia.com/terms/b/bollingerbands.asp.

[3] M. López de Prado, Advances in Financial Machine Learning. Wiley, 2018.

[4]

[5]

[6]

[7]
